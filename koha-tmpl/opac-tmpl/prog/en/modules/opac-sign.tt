<!DOCTYPE html>
<html>
<head>
<title>[% IF ( deck )  %][% deck.name %] - Koha[% ELSE %]Koha digital signs[% END %]</title>
<meta name="generator" content="Koha [% Version %]" /> <!-- leave this for stats -->
<link rel="shortcut icon" href="[% IF ( OpacFavicon ) %][% OpacFavicon %][% ELSE %][% themelang %]/includes/favicon.ico[% END %]" type="image/x-icon" />
<meta name="viewport" content="width=device-width, initial-scale=1">

[%# FIXME Use the JQM files from JQM in early stages of development, to be replaced with a local version later %]
[%# <script type="text/javascript" src="[% themelang % ]/lib/jquery/jquery.js"></script> %]
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>

</head>
<body>

<h1>Signs</h1>

[% IF ( enabled == 0 )  %]
  <p>Digital signs are not enabled!</p>
[% ELSE %]

  [% IF ( deck )  %]

    <h2>[% deck.name %]</h2>

    [% IF ( signs.0 )  %]

      [%# Build an index page, listing all the signs %]
      <div data-role="page" id="index">
        <div data-role="header">
	        <h1>Signs in this deck</h1>
        </div>
        <div data-role="content">
          <p>FIXME This page is only a convenience - the first page shown should be the first page of the first sign.</p>
          <ul data-role="listview">
          [% FOREACH s IN signs %]
            <li><a href="#sign_[% s.sign_id %]">[% s.name %]</a></li>
          [% END %]
          </ul>
        </div>
        <div data-role="footer">
          <h4>Page Footer</h4>
        </div>
      </div>

      [%# Iterate through the signs, creating one front page for each %]
      [% FOREACH s IN signs %]
        <div data-role="page" id="sign_[% s.sign_id %]">
          <div data-role="header">
            <a href="#index" data-rel="back">Back</a>
		        <h1>[% s.name %]</h1>
          </div>
          <div data-role="content">
            <p>FIXME This should be a grid of covers, not a list of titles.</p>
            <ul data-role="listview">
            [% FOREACH r IN s.records %]
              <li><a href="#biblio[% r.biblionumber %]">[% r.biblionumber %] [% r.title %]</a></li>
            [% END %]
            </ul>
          </div>
          <div data-role="footer">
            <h4>Page Footer</h4>
          </div>
        </div>
      [% END %]

      [%# Iterate through the unique records, creating one page for each %]
      [% FOREACH biblionumber = records.keys %]
        <div data-role="page" id="biblio[% biblionumber %]">
          <div data-role="header">
            <a href="#" data-rel="back">Back</a>
	          <h1>[% records.$biblionumber.title %]</h1>
          </div>
          <div data-role="content">
            <p>Details here</p>
          </div>
          <div data-role="footer">
            <h4>Page Footer</h4>
          </div>
        </div>
      [% END %]

    [% ELSE %]
      <p>No signs attached to this deck.</p>
    [% END %]

  [% ELSE %]
    <p>Oops!</p>
  [% END %]

[% END %]

</body>
</html>
